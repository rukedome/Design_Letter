<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>write-letter</title>
  <link rel="stylesheet" href="./css/style.css">
  <style>
    main {
      display: flex;
      justify-content: center;
      align-items: center;
      height: calc(100vh - 100px);
    }

    :root {
      --text-color: #646B8C;
      --headline-color: #B1262B;
      --mail: #555B77;
      --mail-triangle: #494F69;
      --mail-background: #404660;
      --mail-shadow: #D1D6EE;
      --paper: #fff;
      --paper-border: #D1D6EE;
      --confirm-color: #fff;
      --confirm-background: #1D4983;
      --game-paddle: #404660;
      --game-ball: #275EFE;
      --controls-text: #646B8C;
      --controls-icon: #646B8C;
      --controls-background: #E1E6F9;
    }

    #unsubscribe,
    #game {
      button {
        outline: none;
        border: none;
        display: table;
        margin: 0 auto;
        font-size: 20px;
        font-weight: 600;
        font-family: inherit;
        padding: 20px 40px;
        line-height: 21px;
        border-radius: 7px;
        cursor: pointer;
        -webkit-appearance: none;
        -webkit-tap-highlight-color: transparent;
      }
    }

    #unsubscribe {
      margin-bottom: 100px;

      .letter {
        width: 84px;
        height: 72px;
        margin: 0 auto 32px auto;
        position: relative;
        animation: letter 2s ease infinite;

        &:before,
        &:after {
          content: '';
          position: absolute;
          left: 0;
          bottom: 0;
          width: 100%;
          height: 48px;
          z-index: 1;
        }

        &:before {
          background: var(--mail);
          clip-path: polygon(0 0, 50% 55%, 100% 0, 100% 100%, 0 100%);
        }

        &:after {
          background: var(--mail-triangle);
          clip-path: polygon(0 100%, 50% 55%, 100% 100%);
        }

        .background {
          position: absolute;
          left: 0;
          top: 0;
          width: 100%;
          height: 100%;
          background: var(--mail-background);
          clip-path: polygon(0 24px, 50% 0, 100% 24px, 100% 100%, 0 100%);
        }

        .shadow {
          background: black;
          width: 92px;
          height: 4px;
          border-radius: 50%;
          position: absolute;
          top: 108%;
          left: -4px;
          background: var(--mail-shadow);
          animation: shadow 2s ease infinite;
        }

        .body {
          /* width: 360px;
          height: 260px; */
          width: 800px;
          height: 480px;
          bottom: -35px;
          left: -358px;
          border-radius: 1px;
          background: var(--paper);
          box-shadow: inset 0 0 0 1px var(--paper-border);
          position: absolute;
          transform: translateY(36%) translateZ(0) scale(0.15, .06) rotate(90deg);

          .game {
            /* width: 360px;
            height: 260px; */
            width: 800px;
            height: 480px;
            position: relative;
            transition: opacity .3s ease .8s;

            .headline {
              position: absolute;
              left: 0;
              right: 0;
              top: -32px;
              display: flex;
              justify-content: space-between;
              align-items: center;
              transform: translateZ(0);

              span {
                font-size: 30px;
                font-weight: 600;
                line-height: 24px;
                color: #000;
              }
            }

            .controls {
              left: 0;
              right: 0;
              position: absolute;
              height: 100%;

              span {
                display: block;
                text-align: center;
                margin-bottom: 12px;
                font-size: 14px;
                font-weight: 500;
                color: var(--controls-text);
              }
            }
          }
        }
      }

      h1 {
        text-align: left;
        margin: 0 0 8px 8px;
        font-family: inherit;
        font-weight: 600;
        font-size: 30px;
        color: var(--headline-color);
      }

      p {
        text-align: center;
        margin: 0;
        font-size: 16px;
        color: var(--text-color);
      }

      .cta {
        margin-top: 32px;

        button {
          color: var(--confirm-color);
          background: var(--confirm-background);
        }
      }

      &:not(.show-game) {
        .letter {
          .body {
            .game {
              opacity: 0;
              pointer-events: none;
              transition-delay: 0s;
            }
          }
        }
      }

      &.show-game {
        .letter {
          animation-play-state: paused;

          .body {
            animation: paper .8s linear forwards;
          }

          .shadow {
            animation-play-state: paused;
          }
        }
      }

      &.hide-game {
        .letter {
          .body {
            animation: paper-back .8s linear forwards;
          }
        }
      }
    }

    @keyframes paper {
      30% {
        z-index: 0;
        transform: translateY(18%) translateZ(0) scale(0.15, .06) rotate(90deg);
      }

      60%,
      100% {
        z-index: 2;
      }

      60% {
        transform: translateY(0) translateZ(0) scale(0.15, .06) rotate(0deg);
      }

      100% {
        transform: translateY(63%) translateZ(0);
      }
    }

    @keyframes paper-back {
      0% {
        transform: translateY(63%) translateZ(0);
      }

      30% {
        transform: translateY(0) translateZ(0) scale(0.15, .06) rotate(0deg);
      }

      60% {
        z-index: 0;
        transform: translateY(18%) translateZ(0) scale(0.15, .06) rotate(90deg);
      }

      0%,
      30% {
        z-index: 2;
      }

      100% {
        transform: translateY(36%) translateZ(0) scale(0.15, .06) rotate(90deg);
      }
    }

    @keyframes letter {
      50% {
        transform: translateY(-4px);
      }
    }

    @keyframes shadow {
      50% {
        opacity: .7;
        transform: translateY(4px) scale(.8);
      }
    }

    html {
      box-sizing: border-box;
      -webkit-font-smoothing: antialiased;
    }

    * {
      box-sizing: inherit;

      &:before,
      &:after {
        box-sizing: inherit;
      }
    }

    body {
      min-height: 100vh;
      background: #F2F5FF;

      .twitter {
        position: fixed;
        display: block;
        right: 24px;
        bottom: 24px;

        svg {
          width: 32px;
          height: 32px;
          fill: #1da1f2;
        }
      }
    }

    .letter-form h1 {
      color: #333;
      font-size: 1.5rem;
      margin-bottom: 20px;
    }

    textarea {
      width: 100%;
      height: 100%;
      border: 2px solid #9cb3f5;
      border-radius: 8px;
      padding: 10px;
      font-size: 1rem;
      resize: none;
    }

    .letter-form-footer {
      margin-top: 20px;
      display: flex;
      justify-content: space-between;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      border: none;
      color: white;
    }

    .btn-cancel {
      background-color: #B32529;
      padding: 20px;
      margin: 0px !important;
      width: 180px;
    }

    .btn-submit {
      background-color: #1D4983;
      padding: 20px;
      margin: 0px !important;
      width: 580px;
    }

    .letter-counter {
      font-size: 0.8rem;
      color: #999;
      margin-top: 10px;
      text-align: right;
    }
  </style>
</head>

<body>
  <header>
    <div class="logo">
      <a href="main.html" style="height: 20px;"><img src="./images/logo.png"></a>
      <span>Letters to Strangers</span>
    </div>
    <nav>
      <ul>
        <li><a href="about.html">About</a></li>
        <li><a href="how-it-works.html">How It Works</a></li>
        <li><a href="write-letter.html">Write a Letter</a></li>
        <li><a href="find-mailbox.html">Find Mailbox</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <div id="unsubscribe">
      <div class="letter">
        <div class="shadow"></div>
        <div class="background"></div>
        <div class="body">
          <div class="game idle">
            <div class="headline">
              <span>Now let's write a letter!</span>
            </div>
            <div class="controls">
              <textarea id="letter" placeholder="Hello there!" maxlength="1000"></textarea>
              <div class="letter-counter">0/1000</div>
        
              <div class="letter-form-footer">
                <button class="btn btn-cancel">Cancel</button>
                <button class="btn btn-submit">Submit</button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <h1>Let’s write the letter!</h1>
      <p>It’s really easy and simple!</p>
      <div class="cta">
        <button class="confirm">
          Start Here
        </button>
      </div>
    </div>
  </main>


  <script>
    const textarea = document.getElementById('letter');
    const counter = document.querySelector('.letter-counter');

    textarea.addEventListener('input', function () {
      const textLength = textarea.value.length;
      counter.textContent = `${textLength}/1000`;
    });

    const $ = (s, o = document) => o.querySelector(s);
    const $$ = (s, o = document) => o.querySelectorAll(s);

    var unsubscribe = $('#unsubscribe'),
      game = $('.game', unsubscribe),
      confirmButton = $('.confirm', unsubscribe),
      startButton = $('.start', game),
      closeButton = $('.btn-cancel', game);

    confirmButton.addEventListener('click', e => {
      unsubscribe.classList.add('show-game');
    });
    
    closeButton.addEventListener('click', e => {
      unsubscribe.classList.add('hide-game');
      unsubscribe.classList.remove('show-game');
      setTimeout(() => unsubscribe.classList.remove('hide-game'), 800);
    });

  </script>
</body>

</html>